Ext.onReady(function(){Ext.BLANK_IMAGE_URL="../../Ext/2.2/resources/images/default/s.gif";var a=new Ext.state.CookieProvider({expires:new Date(new Date().getTime()+(1000*60*60*24*365))});Ext.state.Manager.setProvider(a);com.ebay.widgets.needs({baseUrl:"http://w-1.ebay.com/js/607/min/",files:["FindItemsAdvanced.js","GetSingleItem.js"],resources:[].concat(com.ebay.shoppingservice.Shopping.getSingleItem,com.ebay.shoppingservice.Shopping.findItemsAdvanced),callback:function(){var b=new Ext.data.ArrayReader({},[{name:"itemID"},{name:"userID"},{name:"title"},{name:"buyItNowAvailable"},{name:"currentPrice"},{name:"shippingServiceCost"},{name:"quantity"},{name:"quantitySold"},{name:"galleryURL"},{name:"startTime"},{name:"endTime",type:"date",dateFormat:"y-m-d H:i:s"},{name:"listingType"},{name:"listingStatus"}]);var d=new Ext.data.Store({reader:b});function f(g,i,h){return String.format('<img src="{0}"/>',g)}function c(g,i,h){if(g.substr(3)=="0"||g.substr(3)==0){return String.format('<font color="red">{0}</font>',g)}else{return String.format('<font color="green">{0}</font>',g)}}var e=new Ext.grid.GridPanel({title:'eBay Item Analyze (<font color="red">Seller:you want to specify multiple values, use a comma.</font>)',autoHeight:true,store:d,autoScroll:true,selModel:new Ext.grid.RowSelectionModel({}),columns:[{header:"Image",width:100,align:"center",sortable:true,dataIndex:"galleryURL",renderer:f},{header:"Seller ID",width:80,align:"center",sortable:true,dataIndex:"userID"},{header:"Title",width:320,align:"center",sortable:true,dataIndex:"title"},{header:"Buy It Now",width:70,align:"center",sortable:true,dataIndex:"buyItNowAvailable"},{header:"Price",width:55,align:"center",sortable:true,dataIndex:"currentPrice"},{header:"shipping Cost",width:100,align:"center",sortable:true,dataIndex:"shippingServiceCost",renderer:c},{header:"Quantity",width:60,align:"center",sortable:true,dataIndex:"quantity"},{header:"Sold Quantity",width:80,align:"center",sortable:true,dataIndex:"quantitySold"},{header:"Start Time",width:130,align:"center",sortable:true,dataIndex:"startTime"},{header:"End Time",width:130,align:"center",sortable:true,dataIndex:"endTime"},{header:"Type",width:60,align:"center",sortable:true,dataIndex:"listingType"},{header:"Status",width:60,align:"center",sortable:true,dataIndex:"listingStatus"}],tbar:[{xtype:"tbtext",text:"Store Name:"},{id:"storeName",name:"storeName",xtype:"textfield",width:120,listeners:{change:function(g,i,h){if(i.length>0){Ext.getCmp("seller").disable()}else{Ext.getCmp("seller").enable()}}}},"-",{xtype:"tbtext",text:"Seller:"},{id:"seller",name:"seller",xtype:"textfield",stateful:true,width:300},"-",{xtype:"tbtext",text:"Keyword:"},{id:"keyword",name:"keyword",xtype:"textfield",width:150},"-",{xtype:"tbtext",text:"End time from:"},{id:"from",name:"from",xtype:"datefield",format:"Y-m-d"},"-",{xtype:"tbtext",text:"End time to:"},{id:"to",name:"to",xtype:"datefield",format:"Y-m-d"},{text:"Submit",handler:function(){function i(q){var r=0;var n=new Array();var t=0;var s=function(y){var x=new Array();x[0]=y.item.itemID;x[1]=y.item.seller.userID;x[2]=y.item.title;x[3]=y.item.buyItNowAvailable;x[4]=y.item.currentPrice.currencyID+y.item.currentPrice.value;x[5]=y.item.shippingCostSummary.shippingServiceCost.currencyID+y.item.shippingCostSummary.shippingServiceCost.value;x[6]=y.item.quantity;x[7]=y.item.quantitySold;x[8]=y.item.galleryURL;x[9]=y.item.startTime;x[10]=y.item.endTime;x[11]=y.item.listingType.value;x[12]=y.item.listingStatus.value;n.push(x);r++;if(r==t){d.loadData(n)}};var w=function(x){Ext.Msg.alert("Warn",x.longMessage)};if(Ext.isArray(q.searchResult[0].itemArray.item)){t=q.searchResult[0].itemArray.item.length;for(j in q.searchResult[0].itemArray.item){if(!Ext.isEmpty(q.searchResult[0].itemArray.item[j].itemID)){var o=new com.ebay.shoppingservice.ShoppingConfig({appId:"eBayAPID-73f4-45f2-b9a3-c8f6388b38d8"});var u=new com.ebay.shoppingservice.Shopping(o);var p=new com.ebay.shoppingservice.GetSingleItemRequestType({ItemID:q.searchResult[0].itemArray.item[j].itemID,IncludeSelector:"Details,ShippingCosts"});var v=new com.ebay.shoppingservice.ShoppingCallback({success:s,failure:w});u.getSingleItem(p,v)}}}else{}}function g(n){Ext.Msg.alert(n[0].severityCode.value,n[0].longMessage)}var h=new com.ebay.shoppingservice.ShoppingConfig({appId:"eBayAPID-73f4-45f2-b9a3-c8f6388b38d8"});var l=new com.ebay.shoppingservice.Shopping(h);var k=new com.ebay.shoppingservice.FindItemsAdvancedRequestType({QueryKeywords:Ext.getCmp("keyword").getValue(),StoreName:Ext.getCmp("storeName").getValue(),SellerID:Ext.getCmp("seller").getValue(),MaxEntries:10,EndTimeFrom:Ext.isEmpty(Ext.getCmp("from").getValue())?null:Ext.getCmp("from").getValue().format("Y-m-d"),EndTimeTo:Ext.isEmpty(Ext.getCmp("to").getValue())?null:Ext.getCmp("to").getValue().format("Y-m-d")});var m=new com.ebay.shoppingservice.ShoppingCallback({success:i,failure:g});l.findItemsAdvanced(k,m)}}]});e.render(document.body)}})});