var currency_data=[["USD","USD"],["EUR","EUR"],["GBP","GBP"],["AUD","AUD"],["RMB","RMB"],["CAD","CAD"]];Ext.override(QoDesk.Orders,{createWindow:function(){var d=this.app.getDesktop();var c=d.getWindow("orders-win");var b=function(){var f=Ext.getCmp("search-order-form").getForm();var l=new Ext.data.JsonStore({root:"records",totalProperty:"totalCount",idProperty:"id",baseParams:{id:f.findField("id").getValue(),sellerId:f.findField("sellerId").getValue(),status:f.findField("status").getValue(),remarks:f.findField("remarks").getValue(),buyerId:f.findField("buyerId").getValue(),buyerName:f.findField("buyerName").getValue(),buyerEmail:f.findField("buyerEmail").getValue(),buyerAddress:f.findField("buyerAddress").getValue(),skuId:f.findField("skuId").getValue(),skuTitle:f.findField("skuTitle").getValue(),itemId:f.findField("itemId").getValue(),itemTitle:f.findField("itemTitle").getValue(),createdOnFrom:f.findField("createdOnFrom").getValue(),createdOnTo:f.findField("createdOnTo").getValue(),modifiedOnFrom:f.findField("modifiedOnFrom").getValue(),modifiedOnTo:f.findField("modifiedOnTo").getValue()},fields:["id","sellerId","buyerId","ebayName","ebayEmail","grandTotalCurrency","grandTotalValue","amountPayCurrency","amountPayValue","status"],url:"connect.php?moduleId=qo-orders&action=searchOrder"});function i(m,o,n){return String.format('<font color="red">{0} {1}</font>',n.data.grandTotalCurrency,m)}function h(m,o,n){if(m==null){return""}else{return String.format('<font color="green">{0} {1}</font>',n.data.amountPayCurrency,m)}}function e(m,o,n){return lang.orders.orders_status_json[m]}function k(m,o,n){return String.format("{0}<br>{1}",n.data.ebayName,n.data.ebayEmail)}var g=new Ext.grid.GridPanel({store:l,columns:[{header:lang.orders.grid_orders_id_header,dataIndex:"id",width:110,align:"center",sortable:true},{header:lang.orders.grid_seller_id_header,dataIndex:"sellerId",width:100,align:"center",sortable:true},{header:lang.orders.grid_buyer_id_header,dataIndex:"buyerId",width:150,renderer:k,align:"center",sortable:true},{header:lang.orders.grid_grand_total_header,dataIndex:"grandTotalValue",width:100,renderer:i,align:"center",sortable:true},{header:lang.orders.grid_amount_pay_header,dataIndex:"amountPayValue",width:100,renderer:h,align:"center",sortable:true},{header:lang.orders.grid_status_header,dataIndex:"status",width:120,renderer:e,align:"center",sortable:true}],bbar:new Ext.PagingToolbar({pageSize:20,store:l,displayInfo:true})});g.on("rowdblclick",function(n){var m=n.getSelectionModel().getSelected();window.open("http://127.0.0.1:6666/eBayBO/orders.php?id="+m.data.id,"_blank","toolbar=no, location=yes, directories=no, status=no, menubar=yes, scrollbars=yes, resizable=no, copyhistory=yes, width=1000, height=800")});l.load({params:{start:0,limit:20}});var j=d.createWindow({title:lang.orders.search_result,width:700,height:400,iconCls:"orders-icon",shim:false,animCollapse:false,constrainHeader:true,layout:"fit",items:g,taskbuttonTooltip:lang.orders.task_button_tooltip});j.show()};var a=function(){window.open("http://127.0.0.1:6666/eBayBO/create_orders.php","_blank","toolbar=no, location=yes, directories=no, status=no, menubar=yes, scrollbars=yes, resizable=no, copyhistory=yes, width=1000, height=800")};if(!c){c=d.createWindow({id:"orders-win",title:lang.orders.search_orders,width:600,height:400,iconCls:"orders-icon",shim:false,animCollapse:false,constrainHeader:true,layout:"fit",items:[{id:"search-order-form",xtype:"form",width:600,border:false,items:[{layout:"column",items:[{columnWidth:0.5,layout:"form",defaults:{width:180},items:[{xtype:"textfield",fieldLabel:lang.orders.form_orders_id,name:"id"},{xtype:"combo",fieldLabel:lang.orders.form_seller_id,mode:"local",store:new Ext.data.JsonStore({autoLoad:true,fields:["id","name"],url:"connect.php?moduleId=qo-transactions&action=getSeller"}),valueField:"id",displayField:"name",triggerAction:"all",editable:false,selectOnFocus:true,name:"sellerId",hiddenName:"sellerId"},{xtype:"combo",fieldLabel:lang.orders.form_status,store:new Ext.data.SimpleStore({fields:["id","name"],data:lang.orders.orders_status}),mode:"local",valueField:"id",displayField:"name",triggerAction:"all",editable:false,name:"status",hiddenName:"status"},{xtype:"textarea",fieldLabel:lang.orders.form_remarks,name:"remarks"}]},{columnWidth:0.5,layout:"form",defaults:{width:180},items:[{xtype:"textfield",fieldLabel:lang.orders.form_buyer_id,name:"buyerId"},{xtype:"textfield",fieldLabel:lang.orders.form_buyer_name,name:"buyerName"},{xtype:"textfield",fieldLabel:lang.orders.form_buyer_email,name:"buyerEmail"},{xtype:"textarea",fieldLabel:lang.orders.form_buyer_address,name:"buyerAddress"}]}]},{layout:"table",layoutConfig:{columns:3},defaults:{border:false},width:600,items:[{html:lang.orders.form_sku},{layout:"form",labelWidth:30,cellCls:"orders-search-create-time",items:[{xtype:"textfield",fieldLabel:lang.orders.form_sku_id,name:"skuId"}]},{layout:"form",labelWidth:30,cellCls:"orders-search-create-time",items:[{xtype:"textfield",fieldLabel:lang.orders.form_sku_title,name:"skuTitle"}]},{html:lang.orders.form_item},{layout:"form",labelWidth:30,cellCls:"orders-search-create-time",items:[{xtype:"textfield",fieldLabel:lang.orders.form_item_id,name:"itemId"}]},{layout:"form",labelWidth:30,cellCls:"orders-search-create-time",items:[{xtype:"textfield",fieldLabel:lang.orders.form_item_title,name:"itemTitle"}]},{html:lang.orders.form_created_date},{layout:"form",labelWidth:30,cellCls:"orders-search-create-time",items:[{xtype:"datefield",fieldLabel:lang.orders.form_start,name:"createdOnFrom",format:"Y-m-d"}]},{layout:"form",labelWidth:30,cellCls:"orders-search-create-time",items:[{xtype:"datefield",fieldLabel:lang.orders.form_end,name:"createdOnTo",format:"Y-m-d"}]},{html:lang.orders.form_modified_date},{layout:"form",labelWidth:30,cellCls:"orders-search-create-time",items:[{xtype:"datefield",fieldLabel:lang.orders.form_start,name:"modifiedOnFrom",format:"Y-m-d"}]},{layout:"form",labelWidth:30,cellCls:"orders-search-create-time",items:[{xtype:"datefield",fieldLabel:lang.orders.form_end,name:"modifiedOnTo",format:"Y-m-d"}]}]}],buttons:[{text:lang.orders.submit,handler:function(){b();c.close()}},{text:lang.orders.create_orders,handler:function(){a()}},{text:lang.orders.close_windows,handler:function(){c.close()}}]}],taskbuttonTooltip:"<b>订单查询</b><br />查询eBay订单"})}c.show()}});